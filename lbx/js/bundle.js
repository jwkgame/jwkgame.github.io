var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])};return function(n,t){function __(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}();!function(){return function r(e,n,t){function o(a,s){if(!n[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(n){return o(e[a][1][n]||n)},c,c.exports,r,e,n,t)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<t.length;a++)o(t[a]);return o}}()({1:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=e("./script/GameUI"),a=function(){function GameConfig(){}return GameConfig.init=function(){(0,Laya.ClassUtils.regClass)("script/GameUI.ts",i.default)},GameConfig.width=1280,GameConfig.height=720,GameConfig.scaleMode="showall",GameConfig.screenMode="horizontal",GameConfig.alignV="middle",GameConfig.alignH="center",GameConfig.startScene="GameScene.scene",GameConfig.sceneRoot="",GameConfig.debug=!1,GameConfig.stat=!1,GameConfig}();t.default=a,a.init()},{"./script/GameUI":7}],2:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=e("./GameConfig");new(function(){function Main(){window.Laya3D?Laya3D.init(i.default.width,i.default.height):Laya.init(i.default.width,i.default.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=i.default.scaleMode,Laya.stage.screenMode=i.default.screenMode,(i.default.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),i.default.stat&&Laya.Stat.show(),Laya.alertGlobalError=!0,Laya.ResourceVersion.enable("version.json",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)}return Main.prototype.onVersionLoaded=function(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))},Main.prototype.onConfigLoaded=function(){i.default.startScene&&Laya.Scene.open(i.default.startScene)},Main}())},{"./GameConfig":1}],3:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=laya.maths.Point,a=e("../script/GameUI"),o=function(){function CommonUnitis(){}return CommonUnitis.localToGlobal=function(e){return this.CalcLocalPoint(e,new i)},CommonUnitis.CalcLocalPoint=function(e,n){if(e.parent){n.x=n.x+e.x,n.y=n.y+e.y;var t=e.parent;this.CalcLocalPoint(t,n)}return n},CommonUnitis.localToGlobal2=function(e){return this.CalcLocalPoint2(e,new i)},CommonUnitis.CalcLocalPoint2=function(e,n){if(!(e.parent instanceof a.default)){n.x=n.x+e.x,n.y=n.y+e.y;var t=e.parent;this.CalcLocalPoint2(t,n)}return n},CommonUnitis.get2AryIntersect=function(e,n){for(var t=[],i=0;i<e.length;i++)for(var a=0;a<n.length;a++)n[a]==e[i]&&t.push(n[a]);return t},CommonUnitis.check2AryIsEqual=function(e,n){for(var t=0;t<e.length;t++)if(n[t]!=e[t])return!1;return!0},CommonUnitis}();t.CommonUnitis=o},{"../script/GameUI":7}],4:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=laya.maths.Point,a=function(){function FKConfig(){this.liubianxingH=28,this.liubianxingA=32.5,this.a=28,this.h=32,this._posList=[{count:5,srcPos:new laya.maths.Point(0,0)},{count:6,srcPos:new i(2*this.liubianxingH,0)},{count:7,srcPos:new i(2*this.liubianxingH*2,0)},{count:8,srcPos:new i(2*this.liubianxingH*3,0)},{count:9,srcPos:new i(2*this.liubianxingH*4,0)},{count:8,srcPos:new i(2*this.liubianxingH*4+this.liubianxingH,3*this.liubianxingA/2)},{count:7,srcPos:new i(2*this.liubianxingH*4+2*this.liubianxingH,3*this.liubianxingA*2/2)},{count:6,srcPos:new i(2*this.liubianxingH*4+3*this.liubianxingH,3*this.liubianxingA*3/2)},{count:5,srcPos:new i(2*this.liubianxingH*4+4*this.liubianxingH,3*this.liubianxingA*4/2)}]}return Object.defineProperty(FKConfig,"Default",{get:function(){return null==this._default?new FKConfig:this._default},enumerable:!0,configurable:!0}),FKConfig.prototype.getTheConfig=function(){var e=32.5,n=28;return[[new i(0,0)],[new i(0,0),new i(56,0)],[new i(0,0),new i(n,48.75)],[new i(0,0),new i(n,-48.75)],[new i(0,0),new i(56,0),new i(112,0)],[new i(0,0),new i(56,0),new i(84,48.75)],[new i(0,0),new i(56,0),new i(84,-48.75)],[new i(0,0),new i(56,0),new i(n,48.75)],[new i(0,0),new i(56,0),new i(n,-48.75)],[new i(0,0),new i(n,48.75),new i(84,48.75)],[new i(0,0),new i(n,48.75),new i(56,3*e)],[new i(0,0),new i(n,48.75),new i(0,3*e)],[new i(0,0),new i(n,-48.75),new i(84,-48.75)],[new i(0,0),new i(n,-48.75),new i(56,3*-e)],[new i(0,0),new i(n,-48.75),new i(0,3*-e)],[new i(0,0),new i(56,0),new i(112,0),new i(168,0)],[new i(0,0),new i(56,0),new i(112,0),new i(140,48.75)],[new i(0,0),new i(56,0),new i(112,0),new i(140,-48.75)],[new i(0,0),new i(56,0),new i(112,0),new i(84,48.75)],[new i(0,0),new i(56,0),new i(112,0),new i(84,-48.75)],[new i(0,0),new i(56,0),new i(84,48.75),new i(n,48.75)],[new i(0,0),new i(56,0),new i(84,48.75),new i(56,3*e)],[new i(0,0),new i(56,0),new i(84,48.75),new i(112,3*e)],[new i(0,0),new i(56,0),new i(84,48.75),new i(140,48.75)],[new i(0,0),new i(56,0),new i(84,-48.75),new i(n,-48.75)],[new i(0,0),new i(56,0),new i(84,-48.75),new i(56,3*-e)],[new i(0,0),new i(56,0),new i(84,-48.75),new i(112,3*-e)],[new i(0,0),new i(56,0),new i(84,-48.75),new i(140,-48.75)],[new i(0,0),new i(56,0),new i(n,-48.75),new i(-n,-48.75)],[new i(0,0),new i(56,0),new i(n,-48.75),new i(0,3*-e)],[new i(0,0),new i(56,0),new i(n,-48.75),new i(56,3*-e)],[new i(0,0),new i(n,-48.75),new i(56,3*-e),new i(84,4.5*-e)],[new i(0,0),new i(-n,-48.75),new i(-56,3*-e),new i(-84,4.5*-e)]]},Object.defineProperty(FKConfig.prototype,"posList",{get:function(){return this._posList},enumerable:!0,configurable:!0}),Object.defineProperty(FKConfig.prototype,"disList",{get:function(){return[[0,1,2,3,4],[5,6,7,8,9,10],[11,12,13,14,15,16,17],[18,19,20,21,22,23,24,25],[26,27,28,29,30,31,32,33,34],[35,36,37,38,39,40,41,42],[43,44,45,46,47,48,49],[50,51,52,53,54,55],[56,57,58,59,60],[26,35,43,50,56],[18,27,36,44,51,57],[11,19,28,37,45,52,58],[5,12,20,29,38,46,53,59],[0,6,13,21,30,39,47,54,60],[1,7,14,22,31,40,48,55],[2,8,15,23,32,41,49],[3,9,16,24,33,42],[4,10,17,25,34],[0,5,11,18,26],[1,6,12,19,27,35],[2,7,13,20,28,36,43],[3,8,14,21,29,37,44,50],[4,9,15,22,30,38,45,51,56],[10,16,23,31,39,46,52,57],[17,24,32,40,47,53,58],[25,33,41,48,54,59],[34,42,49,55,60]]},enumerable:!0,configurable:!0}),FKConfig}();t.FKConfig=a},{}],5:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=laya.maths.Point,a=e("./QipanKuang"),o=e("./FKConfig"),r=e("./CommonUnitis"),s=function(){function LbxQipan(){this.liubianxingH=28,this.liubianxingA=32.5,this._frameList=[],this.posList=o.FKConfig.Default.posList}return Object.defineProperty(LbxQipan.prototype,"frameList",{get:function(){return this._frameList},enumerable:!0,configurable:!0}),Object.defineProperty(LbxQipan,"Default",{get:function(){return null==this._default&&(this._default=new LbxQipan),this._default},enumerable:!0,configurable:!0}),LbxQipan.prototype.init=function(e,n){if(this.box_qipan=e,this.box_bian=n,!(e.numChildren>60)){for(var t=new a.Qipan,o=0,s=0;o<this.posList.length;o++)for(var l=this.posList[o].count,u=this.posList[o].srcPos,c=0;c<l;c++){var h=new a.QipanKuang;h.name="QipanKuang"+s,e.addChild(h),this._frameList.push(h),h.x=u.x-c*this.liubianxingH,h.y=u.y+c*this.liubianxingA*1.5,h.localX=h.x+e.x,h.localY=h.y+e.y;var f=r.CommonUnitis.localToGlobal(h);t.kuangPoint=f;var p=new laya.ui.Image;p.name="QipanBian"+s,p.skin="lbx/pics/kuangLiang.png",p.visible=!1,n.addChild(p),p.pos(h.x-14,h.y-10),h.FKindex=s,s++}e.tag=t;for(o=0;o<e.numChildren;o++){var g=e.getChildAt(o);(u=new i).x=g.x,u.y=g.y;g.localToGlobal(u)}}},LbxQipan}();t.LbxQipan=s},{"./CommonUnitis":3,"./FKConfig":4,"./QipanKuang":6}],6:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function QipanKuang(){var n=e.call(this)||this;return n.skin="lbx/pics/kuang.png",n.alpha=1,n}return __extends(QipanKuang,e),Object.defineProperty(QipanKuang.prototype,"FKindex",{get:function(){return this._FKindex},set:function(e){this._FKindex=e},enumerable:!0,configurable:!0}),Object.defineProperty(QipanKuang.prototype,"isHaveFK",{get:function(){return this._isHaveFK},set:function(e){this._isHaveFK=e},enumerable:!0,configurable:!0}),Object.defineProperty(QipanKuang.prototype,"localX",{get:function(){return this._localX},set:function(e){this._localX=e},enumerable:!0,configurable:!0}),Object.defineProperty(QipanKuang.prototype,"localY",{get:function(){return this._localY},set:function(e){this._localY=e},enumerable:!0,configurable:!0}),QipanKuang}(laya.ui.Image);t.QipanKuang=i;var a=function(e){function BianKuang(){var n=e.call(this)||this;return n.skin="lbx/pics/kuangLiang.png",n}return __extends(BianKuang,e),BianKuang}(laya.ui.Image);t.BianKuang=a;var o=function(){function Qipan(){}return Object.defineProperty(Qipan.prototype,"kuangPoint",{set:function(e){this._kuangPoints||(this._kuangPoints=[]),this._kuangPoints.push(e)},enumerable:!0,configurable:!0}),Object.defineProperty(Qipan.prototype,"kuangPoints",{get:function(){return this._kuangPoints},enumerable:!0,configurable:!0}),Qipan.prototype.getIndex=function(e){return this._kuangPoints.indexOf(e)},Qipan.prototype.getPoint=function(e){return this._kuangPoints[e]},Qipan}();t.Qipan=o},{}],7:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=e("./../ui/layaMaxUI"),a=Laya.Point,o=laya.utils.Handler,r=e("../game/LbxQipan"),s=e("../game/QipanKuang"),l=e("../game/FKConfig"),u=e("../game/CommonUnitis"),c=function(e){function GameUI(){var n=e.call(this)||this;return n.drapPoint=new a,n.checkFrameList=[],n.checkFKlist=[],n.isCanDrap=!1,n.dragNodes=[],GameUI.instance=n,Laya.MouseManager.multiTouchEnabled=!1,n}return __extends(GameUI,e),GameUI.prototype.onEnable=function(){this.lbxQipan=r.LbxQipan.Default,this.lbxQipan.init(this.box_qipan,this.box_bian),this.GameStart()},GameUI.prototype.GameStart=function(){this.lbl_history_score.text=localStorage.getItem("HistoryScore")||"0",this.lbl_score.text="0",this.InitUI()},GameUI.prototype.InitUI=function(){this.scor.visible=!1,this.box_game_over.visible=!1,this.box_drag.removeChildren();for(var e=0;e<this.lbxQipan.frameList.length;e++)this.lbxQipan.frameList[e].isHaveFK=!1;for(e=0;e<3;e++)this.createLbxKuang(this["box"+e]);this.checkIsLose()},GameUI.prototype.newOneK=function(e){var n=new laya.ui.Image;return n.skin="lbx/pics/color_"+e+".png",n},GameUI.prototype.createLbxKuang=function(e,n){void 0===n&&(n=null);var t=new s.Qipan,i=l.FKConfig.Default.getTheConfig(),a=i[Math.floor(Math.random()*(i.length-1))],o=Math.floor(6*Math.random()+1),r=0;n&&(e.x=n.x,e.y=n.y),e.removeChildren();var c=new laya.ui.Box;c.name="node",c.tag=a;for(var h=0;h<a.length;h++){var f=a[h],p=this.newOneK(o);c.addChild(p),p.x=f.x,p.y=f.y,r=p.y}e.addChild(c),c.x=.5*(e.width-c.width),c.y=.5*(e.height-c.height)+.5*(r>0?0:Math.abs(r)),e.scale(.7,.7);for(var g=0,d=c._children;g<d.length;g++){var m=d[g],y=u.CommonUnitis.localToGlobal2(m);t.kuangPoint=y}return e.tag=t,e},GameUI.prototype.checkIsLose=function(){for(var e=0,n=0;n<3;n++){var t=this["box"+n].getChildByName("node");this.checkSelfIsLose(t)?(e++,t.alpha=.2,this["box"+n].off(laya.events.Event.MOUSE_DOWN,this,this.onMouseDown)):(t.alpha=1,this["box"+n].once(laya.events.Event.MOUSE_DOWN,this,this.onMouseDown))}3==e&&Laya.timer.once(2e3,this,this.sendSaveScore,[])},GameUI.prototype.sendSaveScore=function(e){console.log(">>>>",this.lbl_score.text)},GameUI.prototype.miniGameSaveScoreResult=function(e){0==e.resCode&&(this.lbl_history_score.text=""+e.maxScore,this.txt_over.text="你已经输了\n\n当前得分:"+this.lbl_score.text+"\n历史最高:"+e.maxScore,this.box_game_over.visible=!0,this.btn_restart.once(Laya.Event.CLICK,this,this.onClick,[!0]),this.btn_return.once(Laya.Event.CLICK,this,this.onClick,[!1]))},GameUI.prototype.onClick=function(e,n){},GameUI.prototype.miniGameChanceResult=function(e){0==e.resCode?(this.box_game_over.visible=!1,this.InitUI()):(this.box_game_over.visible=!1,this.box_drag.removeChildren())},GameUI.prototype.getItemInfoResult=function(){},GameUI.prototype.checkSelfIsLose=function(e){for(var n=0,t=e._children,i=0;i<this.lbxQipan.frameList.length;i++){var o=this.lbxQipan.frameList[i],r=new a(o.x,o.y),s=1;if(!o.isHaveFK){for(var l=1;l<t.length;l++)for(var u=new a(r.x+t[l].x,r.y+t[l].y),c=0;c<this.lbxQipan.frameList.length;c++){var h=this.lbxQipan.frameList[c];if(u.distance(h.x,h.y)<=27&&!h.isHaveFK){s++;break}}s==t.length&&n++}}return 0==n},GameUI.prototype.addScore=function(e,n){if(void 0===n&&(n=!1),this.scoreJump(this.lbl_score,e,n,!0),!n&&0!=e){for(var t=0,i=1;i<=e;i++)t+=2*i;this.upscore(t+1)}},GameUI.prototype.getAddScoreCal=function(e,n){return void 0===n&&(n=!1),n?1:2*(e+1)},GameUI.prototype.complete2=function(e,n){this.lbl_score.text=(n+Number(this.lbl_score.text)).toString()},GameUI.prototype.scoreJump=function(e,n,t,i){for(void 0===t&&(t=!1),void 0===i&&(i=!1);n>0&&i;){n--,i=!1;var a=this.getAddScoreCal(n,t);this.lbl_score.text=(a+Number(this.lbl_score.text)).toString(),Laya.timer.once(50,this,this.scoreJump,[this.lbl_score,n,t,!0])}},GameUI.prototype.onMouseDown=function(e){var n=e.target;this.drapBox=n,this.drapBox.once(laya.events.Event.DRAG_START,this,this.onDragStart),this.drapBox.on(laya.events.Event.DRAG_MOVE,this,this.onDragMove),this.drapBox.once(laya.events.Event.DRAG_END,this,this.onDragEnd),this.drapBox.once(laya.events.Event.MOUSE_UP,this,this.onDragEnd),n.scale(1,1),this.isCanDrap=!0,n.startDrag()},GameUI.prototype.onDragStart=function(e){var n=this.drapBox;this.drapPoint.x=n.x,this.drapPoint.y=n.y,this.curFKLen=this.drapBox.getChildByName("node").numChildren},GameUI.prototype.onDragMove=function(e){this.checkCollision()},GameUI.prototype.onDragEnd=function(e){if(this.isCanDrap){var n=this.drapBox.getChildByName("node"),t=n._children;if(this.dragNodes.length==t.length){for(var i=[],a=0,o=t;a<o.length;a++){var r=o[a];i.push(r)}n.removeChildren();for(var s=0;s<this.dragNodes.length;s++)this.box_drag.addChild(i[s]),i[s].name="Drag"+this.dragNodes[s].FKindex,i[s].x=this.dragNodes[s].x,i[s].y=this.dragNodes[s].y,this.box_bian.getChildByName("QipanBian"+this.dragNodes[s].FKindex).visible=!1,this.dragNodes[s].isHaveFK=!0;this.dragNodes=[],this.createLbxKuang(this.drapBox,this.drapPoint),this.checkXC()}else"box0"==this.drapBox.name?laya.utils.Tween.to(this.drapBox,{x:790,y:20,scaleX:.7,scaleY:.7},200):"box1"==this.drapBox.name?laya.utils.Tween.to(this.drapBox,{x:790,y:255,scaleX:.7,scaleY:.7},200):"box2"==this.drapBox.name&&laya.utils.Tween.to(this.drapBox,{x:790,y:490,scaleX:.7,scaleY:.7},200);this.checkIsLose(),this.isCanDrap=!1,this.drapBox.off(laya.events.Event.DRAG_MOVE,this,this.onDragMove)}},GameUI.prototype.upscore=function(e){var n=this;this.scor.alpha=1,this.scor.y=340,this.scor.scale(1,1),this.scor.text="+"+e,this.scor.visible=!0,laya.utils.Tween.to(this.scor,{y:240,alpha:.4,scaleX:1.2,scaleY:1.2},1e3,null,o.create(this,function(){n.scor.visible=!1}))},GameUI.prototype.checkXC=function(){this.addScore(this.curFKLen,!0),this.upscore(this.curFKLen);for(var e=[],n=0;n<this.lbxQipan.frameList.length;n++)this.lbxQipan.frameList[n].isHaveFK&&e.push(this.lbxQipan.frameList[n].FKindex);e.sort(function(e,n){return e-n});for(var t=[],i=l.FKConfig.Default.disList,a=0;a<i.length;a++){var o=i[a],r=u.CommonUnitis.get2AryIntersect(e,o);if(r.length>0)u.CommonUnitis.check2AryIsEqual(o,r)&&t.push(o)}var s=0;for(n=0;n<t.length;n++)for(var c=0;c<t[n].length;c++){var h=this.box_drag.getChildByName("Drag"+t[n][c]);this.box_qipan.getChildByName("QipanKuang"+t[n][c]).isHaveFK=!1,Laya.Tween.to(h,{scaleX:1.5,scaleY:1.5,alpha:.5},1e3,Laya.Ease.linearIn,Laya.Handler.create(this,this.complete,[h]),100),s++}this.addScore(s)},GameUI.prototype.complete=function(e){e.removeSelf()},GameUI.prototype.checkCollision=function(){for(var e=0;e<this.lbxQipan.frameList.length;e++)this.box_bian.getChildByName("QipanBian"+e).visible=!1;this.box_qipan.tag;this.dragNodes=[];for(var n=0,t=this.drapBox.tag.kuangPoints;n<t.length;n++){for(var i=t[n],o=0,r=this.box_qipan.tag.kuangPoints;o<r.length;o++){var s=r[o];if(new a(this.drapBox.x+i.x,this.drapBox.y+i.y).distance(s.x,s.y)<=35){var l=this.box_qipan.getChildByName("QipanKuang"+this.box_qipan.tag.getIndex(s));if(l.isHaveFK)return void(this.dragNodes=[]);this.dragNodes.push(l)}}if(this.dragNodes.length<=0)return}if(this.dragNodes.length==this.drapBox.tag.kuangPoints.length)for(var u=0,c=this.dragNodes;u<c.length;u++){var h=c[u];this.box_bian.getChildByName("QipanBian"+h.FKindex).visible=!0}},GameUI.prototype.getDistance=function(e,n){var t=Math.abs(e.x-n.x),i=Math.abs(e.y-n.y);return Math.sqrt(t*t+i*i)},GameUI}(i.ui.GameSceneUI);t.default=c},{"../game/CommonUnitis":3,"../game/FKConfig":4,"../game/LbxQipan":5,"../game/QipanKuang":6,"./../ui/layaMaxUI":8}],8:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Laya.Scene;!function(e){var n=function(e){function GameSceneUI(){return e.call(this)||this}return __extends(GameSceneUI,e),GameSceneUI.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.loadScene("GameScene")},GameSceneUI}(i);e.GameSceneUI=n}(t.ui||(t.ui={}))},{}]},{},[2]);